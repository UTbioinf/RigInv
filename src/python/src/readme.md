# bamExtractor.py

### Output format

Output files will be in the directory `intermediate_results`

* There is a `spec.txt` file with the format:
    * for each line, there are for fileds delimited by a space
        1. `ref_id`: an integer starting from 0
        2. `ref_name`
        3. `ref_len`
        4. `directory of the alignment file`: there might be a spaces in this field, please resolve it appropriately
* In each `alignment file` (`/ref/id/hex/directory/<ref_id>.txt`), the alignment has the following format
    * Each line has the following fields, delimited by a space
        1. `<ref_start>`: start from 0, included
        2. `<ref_end>`: start from 0, excluded
        3. `<qry_start>`: start from 0, included
        4. `<qry_end>`: start from 0, excluded
        5. `<qry_name>`
        6. `<ref_len>`
        7. `<qry_len>`
        8. `<mapping_quality>`
        9. `<orientation>`: `R` or `F`
* **N.B.** The bam file generated by bwa-mem will have `reference_id = -1`. Since we are not sure what this means, we simply skip this alignment for now.

```
usage: bamExtractor [-h] -b BAM [-d DIRECTORY] [-m]

Bam file extractor

optional arguments:
  -h, --help            show this help message and exit
  -b BAM, --bam BAM     bam/sam file name
  -d DIRECTORY, --directory DIRECTORY
                        directory of the output file. If not set, it will be
                        the current directory
  -m, --mk-file         generate the 'inc.mk' file for makefiles
```

# ~~k_means.py~~

**N.B.** We don't need this any more

* Input format
    * each line of the file contains `left_min left_max right_min right_max`
    * if `-k` is set, only run k-means on this k, otherwise, use heuristics to deduce a good k
* Output
    * a `k.txt` file which contains a single integer
        * if the integer is 0, then there is no appropriate clustering at all, stop!!!
        * else, there are this number (say `K`) of clusters
    * `K` files suffixed with `K.in`
        * each file is a cluster
        * each line of each file has the format of `left_min left_max right_min right_max`
            * each of this file will be used to predict a representative rectangle

```
usage: k_means [-h] [-k K] [-i INPUT_FILE] [-d DIRECTORY]

k means clustering algorithm

optional arguments:
  -h, --help            show this help message and exit
  -k K                  Set k for k-means
  -i INPUT_FILE, --input-file INPUT_FILE
                        Input file name
  -d DIRECTORY, --directory DIRECTORY
                        directory of the output file. If not set, it will be
                        the current directory

```
